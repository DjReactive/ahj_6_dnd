!function(){"use strict";function e(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class t{static mousedown(e){const{target:s}=e;if(!s.classList.contains("card")||t.selectedItem)return;if(0!==e.button)return;t.copyItem=s,t.selectedItem=s,t.selectedItem.classList.add("selected"),t.draggedItem=s.cloneNode(!0),t.draggedItem.classList.add("dragged"),t.selectedItem.innerHTML="";const d=t.selectedItem.offsetWidth,n=t.selectedItem.offsetHeight,o=t.selectedItem.getBoundingClientRect(),{scrollLeft:r,scrollTop:i}=document.body,a=o.left+r,l=o.top+i;t.startX=e.clientX,t.startY=e.clientY,t.draggedItem.style.width=`${d}px`,t.draggedItem.style.height=`${n}px`,t.draggedItem.style.top=`${l}px`,t.draggedItem.style.left=`${a}px`,t.ghostPosition=t.selectedItem.closest("td"),document.body.style.cursor="grabbing",document.body.appendChild(t.draggedItem),t.mouseDown=!0}static mousemove(e){if(!t.selectedItem)return;switch(!0){case e.target.classList.contains("card"):t.ghostThink(e,"onCard");break;case e.target.classList.contains("list"):t.ghostThink(e,"onList");break;case e.target===e.target.closest("td"):t.ghostThink(e,"onTable");break;default:t.ghostRemove()}let s=0;const d=t.selectedItem.getBoundingClientRect(),{scrollLeft:n,scrollTop:o}=document.body;t.ghostItem&&t.ghostItem.parentNode===t.selectedItem.parentNode&&t.ghostItem.offsetTop<t.startY&&(s=t.ghostItem.offsetHeight+10);const r=d.left+n+e.clientX-t.startX,i=d.top+o+e.clientY-t.startY-s;t.draggedItem.style.top=`${i}px`,t.draggedItem.style.left=`${r}px`}static mouseup(e,s){if(!t.selectedItem)return;const d=e.clientX,n=e.clientY;t.draggedItem.style.display="none";const o=document.elementFromPoint(d,n);if(o&&e.target!==t.selectedItem){const e=o.closest("td");if(e){const s=e.querySelector(".list");s===t.selectedItem.parentNode?s.replaceChild(t.selectedItem,t.ghostItem):(t.selectedItem.remove(),t.ghostItem.insertAdjacentElement("afterend",t.copyItem))}}t.selectedItem.innerHTML=t.draggedItem.innerHTML,t.selectedItem.classList.remove("selected"),t.selectedItem=null,t.draggedItem.remove(),t.draggedItem=null,t.ghostRemove(),t.ghostItem=null,t.ghostPosition=null,t.ghostFixed=null,t.copyItem=null,document.body.style.cursor="default",s.resortingItems()}static ghostThink(e,s){t.ghostElement(e,s)}static ghostElement(e,s){if(!s)return;if(e.target===t.ghostItem)return;if(t.ghostRemove(),e.target===t.selectedItem)return;const d=document.createElement("div"),{target:n}=e;let o;d.classList.add("card"),d.classList.add("selected"),d.textContent="Put Here!";const r=n.offsetTop+n.offsetHeight/2>e.clientY?"beforebegin":"afterend",i=n.getElementsByClassName("card"),a=n.querySelector(".list");switch(s){case"onCard":n.insertAdjacentElement(r,d);break;case"onList":Array.from(i).forEach((t=>{t.offsetTop<e.clientY&&(o=t)})),o&&o.insertAdjacentElement("afterend",d);break;case"onTable":a&&a.insertAdjacentElement("afterend",d)}t.ghostFixed=s,t.ghostItem=d}static ghostRemove(){t.ghostItem&&t.ghostItem.remove()}}e(t,"selectedItem",null),e(t,"draggedItem",null),e(t,"copyItem",null),e(t,"ghostItem",null),e(t,"ghostPosition",null),e(t,"ghostFixed",null),e(t,"startX",0),e(t,"startY",0),e(t,"timeOut",0);class s{constructor(e){this.draggedEl=null,this.ghostEl=null,this.items=[],this.counterId=0,this.storage=e,this.todo=document.getElementById("todo"),this.inProgress=document.getElementById("inprogress"),this.done=document.getElementById("done"),this.todoAdd=s.getElementColumn(this.todo,"add"),this.inProgressAdd=s.getElementColumn(this.inProgress,"add"),this.doneAdd=s.getElementColumn(this.done,"add")}init(){const e=this.storage.load();e&&(this.items=e),[this.todoAdd,this.inProgressAdd,this.doneAdd].forEach((e=>{this.addStartElements(e)})),this.refresh()}refresh(){const e=document.getElementsByClassName("card");Array.from(e).forEach((e=>e.remove())),this.items.forEach((e=>{const t=document.getElementById(e.list).querySelector(".list");this.addAnotherCard(t,e.value,e.id)})),this.items.length>0&&(this.counterId=this.items[this.items.length-1].id)}addStartElements(e){const d=e.closest("td"),n=s.addElement(e,"div",{class:"add-card hidden"}),o=s.addElement(n,"textarea",{style:"resize: none"}),r=s.addElement(n,"button",{class:"button-add",textContent:"Add Card"}),i=s.addElement(n,"button",{class:"button-close",textContent:"ðŸ—™"}),a=s.addElement(e,"a",{class:"show-div",textContent:"+ Add another card"});document.addEventListener("mousedown",(e=>t.mousedown(e))),document.addEventListener("mousemove",(e=>t.mousemove(e))),document.addEventListener("mouseup",(e=>t.mouseup(e,this))),i.addEventListener("click",(()=>s.hideAddInputCase(n,a))),a.addEventListener("click",(()=>s.showAddInputCase(n,a))),r.addEventListener("click",(()=>{const e=this.generateId();this.items.push({id:e,list:d.getAttribute("id"),value:o.value}),this.addAnotherCard(d.querySelector(".list"),o,e),s.hideAddInputCase(n,a),this.saveItems()}))}addAnotherCard(e,t,d=null){const n=d||this.generateId(),o="string"!=typeof t,r=o?t.value:t,i=s.addElement(e,"div",{class:"card","data-id":`${n}`,textContent:r});s.addElement(i,"button",{class:"remove",textContent:"ðŸ—™"}).addEventListener("click",(()=>this.removeAnotherCard(i))),o&&(t.value="")}removeAnotherCard(e){for(let t=0;t<this.items.length;t++)if(this.items[t].id===Number(e.dataset.id))return this.items.splice(t,1),e.remove(),this.saveItems(),!0;return!1}generateId(){return this.counterId+=1,this.counterId}resortingItems(){const e=document.getElementsByClassName("card"),t=[];Array.from(e).forEach((e=>{const s=this.items.find((t=>String(t.id)===e.dataset.id));s&&(s.list=e.closest("td").getAttribute("id"),t.push(s))})),this.items=t,this.saveItems(),this.refresh()}saveItems(){this.storage.save(this.items)}static addElement(e,t,s={}){const d=document.createElement(t);for(const e of Object.keys(s))"textContent"===e?d.textContent=s[e]:d.setAttribute(e,s[e]);return e.appendChild(d),d}static showAddInputCase(e,t){t.classList.add("hidden"),e.classList.remove("hidden")}static hideAddInputCase(e,t){t.classList.remove("hidden"),e.classList.add("hidden")}static getElementColumn(e,t="list"){return e.querySelector(`.${t}`)}}const d=localStorage,n=new class{constructor(e){this.storage=e}save(e){this.storage.setItem("tasks",JSON.stringify(e))}load(){try{return this.storage.length>0&&JSON.parse(this.storage.getItem("tasks"))}catch(e){throw new Error("Invalid state")}}}(d);new s(n).init()}();